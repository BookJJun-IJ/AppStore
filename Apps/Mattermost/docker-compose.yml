name: mattermost

services:
  postgres:
    image: postgres:13-alpine
    restart: unless-stopped
    deploy:
      resources:
        limits:
          memory: 512M
          cpus: '0.5'
    volumes:
      - /DATA/AppData/$AppID/postgres:/var/lib/postgresql/data
    environment:
      POSTGRES_USER: mmuser
      POSTGRES_PASSWORD: $default_pwd
      POSTGRES_DB: mattermost
      POSTGRES_INITDB_ARGS: "--encoding=UTF-8"
      PGDATA: /var/lib/postgresql/data/pgdata
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U mmuser -d mattermost"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 120s

  mattermost:
    image: mattermost/mattermost-team-edition:10.9.1
    restart: unless-stopped
    depends_on:
      - postgres
    deploy:
      resources:
        limits:
          memory: 1G
          cpus: '1.0'
    expose:
      - 3000
    volumes:
      - /DATA/AppData/$AppID/config:/mattermost/config
      - /DATA/AppData/$AppID/data:/mattermost/data
      - /DATA/AppData/$AppID/logs:/mattermost/logs
      - /DATA/AppData/$AppID/plugins:/mattermost/plugins
      - /DATA/AppData/$AppID/client-plugins:/mattermost/client/plugins
    environment:
      PUID: $PUID
      PGID: $PGID
      TZ: $TZ
      MM_SQLSETTINGS_DRIVERNAME: postgres
      MM_SQLSETTINGS_DATASOURCE: postgres://mmuser:$default_pwd@postgres:5432/mattermost?sslmode=disable&connect_timeout=10
      MM_SERVICESETTINGS_SITEURL: "https://3000-$domain"
      MM_SERVICESETTINGS_LISTENADDRESS: ":3000"
      MM_SERVICESETTINGS_ENABLELOCALMODE: true
      MM_SERVICESETTINGS_ALLOWUNTRUSTEDINTERNALCONNECTIONS: true
      MM_SERVICESETTINGS_ENABLEINSECUREOUTGOINGCONNECTIONS: true
      MM_SERVICESETTINGS_ALLOWCORSFROM: "*"
      MM_SERVICESETTINGS_WEBSOCKETURL: ""
      MM_SERVICESETTINGS_ENABLEFILEATTACHMENTS: true
      MM_PLUGINSETTINGS_ENABLE: true
      MM_PLUGINSETTINGS_ENABLEUPLOADS: true
      MM_PLUGINSETTINGS_AUTOMATICPREPACKAGEDPLUGINS: true
      MM_PLUGINSETTINGS_ENABLEREMOTEMARKETPLACE: true
      MM_FILESETTINGS_MAXFILESIZE: 104857600
      MM_FILESETTINGS_ENABLEFILEATTACHMENTS: true
      MM_FILESETTINGS_ENABLEPUBLICLINK: true
      MM_TEAMSETTINGS_ENABLETEAMCREATION: true
      MM_TEAMSETTINGS_ENABLEUSERCREATION: true
      MM_EMAILSETTINGS_SENDEMAILNOTIFICATIONS: false
      MM_LOGSETTINGS_CONSOLELEVEL: "INFO"
      MM_LOGSETTINGS_FILELEVEL: "INFO"
      # Calls í”ŒëŸ¬ê·¸ì¸ ì„¤ì • - í…ŒìŠ¤íŠ¸ ëª¨ë“œ ë¹„í™œì„±í™”
      MM_PLUGINSETTINGS_PLUGINS_COM_MATTERMOST_CALLS_ENABLEPLUGIN: true
      MM_PLUGINSETTINGS_PLUGINS_COM_MATTERMOST_CALLS_ALLOWUSERSTOSTARTCALLS: true
      MM_PLUGINSETTINGS_PLUGINS_COM_MATTERMOST_CALLS_TESTMODE: false
      MM_PLUGINSETTINGS_PLUGINS_COM_MATTERMOST_CALLS_DEFAULTENABLED: true
      MM_PLUGINSETTINGS_PLUGINS_COM_MATTERMOST_CALLS_ALLOWSCREENSHARING: true

x-casaos:
  architectures: [amd64, arm64]
  main: mattermost
  webui_port: 3000
  author: Yundera Team
  category: Communication
  pre-install-cmd: |
    mkdir -p /DATA/AppData/$AppID/client-plugins &&
    mkdir -p /DATA/AppData/$AppID/config &&
    mkdir -p /DATA/AppData/$AppID/data &&
    mkdir -p /DATA/AppData/$AppID/logs &&
    mkdir -p /DATA/AppData/$AppID/plugins &&
    chmod -R 755 /DATA/AppData/$AppID/
  description:
    en_us: Self-hosted Microsoft Teams alternative with voice calls, video calls, screen sharing and team collaboration
    ko_kr: ìŒì„± í†µí™”, í™”ìƒ í†µí™”, í™”ë©´ ê³µìœ  ë° íŒ€ í˜‘ì—… ê¸°ëŠ¥ì„ ê°–ì¶˜ ìì²´ í˜¸ìŠ¤íŒ… Microsoft Teams ëŒ€ì²´ ì†”ë£¨ì…˜
    fr_fr: Alternative auto-hÃ©bergÃ©e Ã  Microsoft Teams avec appels vocaux, appels vidÃ©o, partage d'Ã©cran et collaboration d'Ã©quipe
    es_es: Alternativa auto-alojada a Microsoft Teams con llamadas de voz, videollamadas, intercambio de pantalla y colaboraciÃ³n en equipo
    zh_cn: å…·æœ‰è¯­éŸ³é€šè¯ã€è§†é¢‘é€šè¯ã€å±å¹•å…±äº«å’Œå›¢é˜Ÿåä½œåŠŸèƒ½çš„è‡ªæ‰˜ç®¡Microsoft Teamsæ›¿ä»£æ–¹æ¡ˆ
  developer: Mattermost, Inc.
  icon: https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/Mattermost/icon.png
  tagline:
    en_us: Microsoft Teams alternative with calling features
    ko_kr: í†µí™” ê¸°ëŠ¥ì„ ê°–ì¶˜ Microsoft Teams ëŒ€ì²´ ì†”ë£¨ì…˜
    fr_fr: Alternative Ã  Microsoft Teams avec fonctionnalitÃ©s d'appel
    es_es: Alternativa a Microsoft Teams con funciones de llamada
    zh_cn: å…·æœ‰é€šè¯åŠŸèƒ½çš„Microsoft Teamsæ›¿ä»£æ–¹æ¡ˆ
  title:
    en_us: Mattermost
    ko_kr: Mattermost
  tips:
    before_install:
      en_us: |
        **Mattermost Teams Alternative**
        
        Ready for Microsoft Teams migration with enterprise features:
        
        ğŸš€ **Core Features:**
        - Team channels & direct messaging
        - File sharing (100MB per file)
        - Mobile & desktop apps
        - Plugin marketplace access
        - Advanced notifications
        
        ğŸ“ **Voice & Video Calls Setup:**
        Calling features are automatically enabled and configured:
        - Voice calls, video calls, and screen sharing ready
        - No manual plugin installation required
        - Test mode disabled for all users
        
        ğŸ“‹ **Quick Start:**
        1. Access: https://3000-mattermost-username.nsl.sh/
        2. Create admin account (first user becomes admin)
        3. Create your team/organization
        4. Start using voice/video calls immediately!
        
        ğŸ¯ **Teams vs Mattermost:**
        - âœ… No per-user licensing fees
        - âœ… Complete data ownership
        - âœ… Better performance (self-hosted)
        - âœ… Full customization control
        
        Database password: $default_pwd
      ko_kr: |
        **Mattermost Teams ëŒ€ì²´ ì†”ë£¨ì…˜**
        
        ì—”í„°í”„ë¼ì´ì¦ˆ ê¸°ëŠ¥ì„ ê°–ì¶˜ Microsoft Teams ë§ˆì´ê·¸ë ˆì´ì…˜ ì¤€ë¹„:
        
        ğŸš€ **í•µì‹¬ ê¸°ëŠ¥:**
        - íŒ€ ì±„ë„ ë° ë‹¤ì´ë ‰íŠ¸ ë©”ì‹œì§•
        - íŒŒì¼ ê³µìœ  (íŒŒì¼ë‹¹ 100MB)
        - ëª¨ë°”ì¼ ë° ë°ìŠ¤í¬í†± ì•±
        - í”ŒëŸ¬ê·¸ì¸ ë§ˆì¼“í”Œë ˆì´ìŠ¤ ì ‘ê·¼
        - ê³ ê¸‰ ì•Œë¦¼ ì‹œìŠ¤í…œ
        
        ğŸ“ **ìŒì„± ë° í™”ìƒ í†µí™” ì„¤ì •:**
        í†µí™” ê¸°ëŠ¥ì´ ìë™ìœ¼ë¡œ í™œì„±í™”ë˜ê³  êµ¬ì„±ë©ë‹ˆë‹¤:
        - ìŒì„± í†µí™”, í™”ìƒ í†µí™”, í™”ë©´ ê³µìœ  ì¤€ë¹„ ì™„ë£Œ
        - ìˆ˜ë™ í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ ë¶ˆí•„ìš”
        - ëª¨ë“  ì‚¬ìš©ìë¥¼ ìœ„í•´ í…ŒìŠ¤íŠ¸ ëª¨ë“œ ë¹„í™œì„±í™”
        
        ğŸ“‹ **ë¹ ë¥¸ ì‹œì‘:**
        1. ì ‘ì†: https://3000-mattermost-username.nsl.sh/
        2. ê´€ë¦¬ì ê³„ì • ìƒì„± (ì²« ì‚¬ìš©ìê°€ ê´€ë¦¬ìê°€ ë¨)
        3. íŒ€/ì¡°ì§ ìƒì„±
        4. ë°”ë¡œ ìŒì„±/í™”ìƒ í†µí™” ì‚¬ìš© ì‹œì‘!
        
        ğŸ¯ **Teams vs Mattermost:**
        - âœ… ì‚¬ìš©ìë‹¹ ë¼ì´ì„ ìŠ¤ ë¹„ìš© ì—†ìŒ
        - âœ… ì™„ì „í•œ ë°ì´í„° ì†Œìœ ê¶Œ
        - âœ… ë” ë‚˜ì€ ì„±ëŠ¥ (ìì²´ í˜¸ìŠ¤íŒ…)
        - âœ… ì™„ì „í•œ ì»¤ìŠ¤í„°ë§ˆì´ì§• ì œì–´
        
        ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸: $default_pwd
  index: /
  port_map: "3000"
  store_app_id: mattermost