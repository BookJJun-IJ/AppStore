name: immich

services:
  immich-server:
    container_name: immich_server
    image: ghcr.io/immich-app/immich-server:release
    command: ['start.sh', 'immich']
    volumes:
      - /DATA/AppData/$AppID/upload:/usr/src/app/upload
      - /etc/localtime:/etc/localtime:ro
    environment:
      DB_HOSTNAME: immich_postgres
      DB_USERNAME: postgres
      DB_PASSWORD: postgres
      DB_DATABASE_NAME: immich
      REDIS_HOSTNAME: immich_redis
      IMMICH_VERSION: release
    ports:
      - 2283:3001
    depends_on:
      - redis
      - database
    restart: unless-stopped
    networks:
      pcs: null

  immich-microservices:
    container_name: immich_microservices
    image: ghcr.io/immich-app/immich-server:release
    extends:
      service: immich-server
    command: ['start.sh', 'microservices']
    ports: []
    depends_on:
      - redis
      - database
    restart: unless-stopped
    networks:
      pcs: null

  immich-machine-learning:
    container_name: immich_machine_learning
    image: ghcr.io/immich-app/immich-machine-learning:release
    volumes:
      - /DATA/AppData/$AppID/model-cache:/cache
    environment:
      IMMICH_VERSION: release
    restart: unless-stopped
    networks:
      pcs: null

  redis:
    container_name: immich_redis
    image: registry.hub.docker.com/library/redis:6.2-alpine@sha256:51d6c56749a4243096327e3fb964a48ed92254357108449cb6e23999c37773c5
    restart: unless-stopped
    networks:
      pcs: null

  database:
    container_name: immich_postgres
    image: registry.hub.docker.com/tensorchord/pgvecto-rs:pg14-v0.2.0@sha256:90724186f0a3517cf6914295b5ab410db9ce23190a2d9d0b9dd6463e3fa298f0
    environment:
      POSTGRES_PASSWORD: postgres
      POSTGRES_USER: postgres
      POSTGRES_DB: immich
    volumes:
      - /DATA/AppData/$AppID/database:/var/lib/postgresql/data
    restart: unless-stopped
    networks:
      pcs: null

networks:
  pcs:
    name: pcs

x-casaos:
  architectures:
    - amd64
    - arm64
  author: self
  category: media
  description:
    en_us: Immich - High performance self-hosted photo and video management solution with machine learning-powered features like facial recognition and smart search
    zh_cn: Immich - 高性能自托管照片和视频管理解决方案，具有面部识别和智能搜索等机器学习功能
    ko_kr: Immich - 얼굴 인식 및 스마트 검색과 같은 머신러닝 기반 기능을 갖춘 고성능 자체 호스팅 사진 및 비디오 관리 솔루션
  icon: https://raw.githubusercontent.com/BookJJun-IJ/AppStore/create/Apps/Immich/icons.png
  screenshot_link:
    - https://raw.githubusercontent.com/BookJJun-IJ/AppStore/create/Apps/Immich/screenshots1.png
    - https://raw.githubusercontent.com/BookJJun-IJ/AppStore/create/Apps/Immich/screenshots2.png
    - https://raw.githubusercontent.com/BookJJun-IJ/AppStore/create/Apps/Immich/screenshots3.png
  index: /
  tagline:
    en_us: Self-hosted photo and video backup solution with AI-powered features
    zh_cn: 具有AI功能的自托管照片和视频备份解决方案
    ko_kr: AI 기반 기능을 갖춘 자체 호스팅 사진 및 비디오 백업 솔루션
  is_uncontrolled: false
  port_map: "2283"
  title: 
    en_us: Immich
    zh_cn: Immich
    ko_kr: Immich
  main: immich-server
  volumes:
    - /DATA/AppData/$AppID/upload
    - /DATA/AppData/$AppID/model-cache
    - /DATA/AppData/$AppID/database