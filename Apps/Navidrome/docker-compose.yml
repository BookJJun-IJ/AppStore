name: navidrome

services:
  navidrome:
    image: deluan/navidrome:0.56.1
    container_name: navidrome
    restart: unless-stopped
    expose:
      - 4533  # Navidrome Web UI Port / Navidrome 웹 UI 포트
    depends_on:
      sample-music-downloader:
        condition: service_completed_successfully
    volumes:
      - /DATA/AppData/$AppID/data:/data        # Navidrome database and configuration directory / Navidrome 데이터베이스 및 설정 디렉토리
      - /DATA/Media/Music:/music               # Music library directory (read-only) / 음악 라이브러리 디렉토리 (읽기 전용)
      - /DATA/Downloads:/downloads             # Downloads directory for temporary music files / 임시 음악 파일용 다운로드 디렉토리
    user: $PUID:$PGID
    environment:
      PGID: $PGID
      PUID: $PUID
      TZ: $TZ                                  # Timezone for the Navidrome service / Navidrome 서비스의 시간대 설정
      ND_MUSICFOLDER: /music                   # Path to your music library inside the container / 컨테이너 내 음악 라이브러리 경로
      ND_DATAFOLDER: /data                     # Path to store Navidrome database and configuration / Navidrome 데이터베이스와 설정을 저장할 경로
      ND_LOGLEVEL: info                        # Log level (debug, info, warn, error) / 로그 레벨 (debug, info, warn, error)
    cpu_shares: 50
    deploy:
      resources:
        limits:
          memory: 512M

  # Init container to download sample music
  sample-music-downloader:
    image: alpine:latest
    container_name: navidrome-sample-music-downloader
    volumes:
      - /DATA/Media/Music:/music
    entrypoint: ["/bin/sh"]
    command: 
      - -c
      - |
        apk add --no-cache curl wget
        echo 'Downloading sample music files...'
        mkdir -p "/music/Sample Music"
        cd "/music/Sample Music"
        
        echo 'Downloading from Jamendo...'
        wget -O 'Chill_Hop_Beat.mp3' 'https://prod-1.storage.jamendo.com/?trackid=1578250&format=mp31&from=app-97e50a68' || true
        wget -O 'Electronic_Ambient.mp3' 'https://prod-1.storage.jamendo.com/?trackid=1565432&format=mp31&from=app-97e50a68' || true
        
        echo 'Downloading from Free Music Archive...'
        wget -O 'Classical_Piano.mp3' 'https://files.freemusicarchive.org/storage-freemusicarchive-org/music/Music_for_Video/Kevin_MacLeod/Classical_Sampler/Kevin_MacLeod_-_04_-_Gymnopedie_No_1.mp3' || true
        wget -O 'Upbeat_Rock.mp3' 'https://files.freemusicarchive.org/storage-freemusicarchive-org/music/Music_for_Video/Kevin_MacLeod/Rock/Kevin_MacLeod_-_01_-_Almost_New.mp3' || true
        wget -O 'Acoustic_Folk.mp3' 'https://files.freemusicarchive.org/storage-freemusicarchive-org/music/Music_for_Video/Scott_Holmes/Indie_Acoustic/Scott_Holmes_-_01_-_Acoustic_Indie_Folk.mp3' || true
        
        echo 'Sample music download completed!'
        ls -la "/music/Sample Music/" || true
    restart: "no"

x-casaos:
  architectures:
    - amd64
    - arm64
  author: CasaOS Team
  category: Media
  developer: Deluan Quintão
  description:
    en_us: |
      **Your Personal Music Streaming Server**
      Navidrome is a modern music server and streamer compatible with Subsonic/Airsonic clients. Stream your music collection from anywhere with a beautiful web interface and mobile apps.
      
      **Key Features:**
      • Beautiful, responsive web interface
      • Compatible with Subsonic apps (iOS/Android)
      • Automatic music library scanning
      • Transcoding and streaming optimization
      • Multi-user support with playlists
      • Last.fm scrobbling support
      
      **Sample Music Included:**
      This installation includes 5 free Creative Commons licensed sample tracks to get you started immediately.
    zh_cn: |
      **您的个人音乐流媒体服务器**
      Navidrome是一个现代音乐服务器和流媒体播放器，兼容Subsonic/Airsonic客户端。通过漂亮的网页界面和移动应用程序从任何地方播放您的音乐收藏。
      
      **主要功能：**
      • 漂亮、响应式的网页界面
      • 兼容Subsonic应用程序（iOS/Android）
      • 自动音乐库扫描
      • 转码和流媒体优化
      • 多用户支持与播放列表
      • Last.fm记录支持
      
      **包含示例音乐：**
      此安装包含5首免费Creative Commons授权的示例曲目，让您立即开始使用。
    ko_kr: |
      **개인 음악 스트리밍 서버**
      Navidrome은 Subsonic/Airsonic 클라이언트와 호환되는 현대적인 음악 서버이자 스트리머입니다. 아름다운 웹 인터페이스와 모바일 앱으로 어디서나 음악 컬렉션을 스트리밍하세요.
      
      **주요 기능:**
      • 아름답고 반응형 웹 인터페이스
      • Subsonic 앱 호환 (iOS/Android)
      • 자동 음악 라이브러리 스캔
      • 트랜스코딩 및 스트리밍 최적화
      • 플레이리스트가 있는 다중 사용자 지원
      • Last.fm 스크로블링 지원
      
      **샘플 음악 포함:**
      이 설치에는 즉시 시작할 수 있도록 5개의 무료 Creative Commons 라이센스 샘플 트랙이 포함되어 있습니다.
  icon: https://cdn.jsdelivr.net/gh/BookJJun-IJ/AppStore@create/Apps/Navidrome/icon.png
  screenshot_link:
    - https://cdn.jsdelivr.net/gh/BookJJun-IJ/AppStore@create/Apps/Navidrome/screenshot-1.png
    - https://cdn.jsdelivr.net/gh/BookJJun-IJ/AppStore@create/Apps/Navidrome/screenshot-2.png
    - https://cdn.jsdelivr.net/gh/BookJJun-IJ/AppStore@create/Apps/Navidrome/screenshot-3.png
  thumbnail: https://cdn.jsdelivr.net/gh/BookJJun-IJ/AppStore@create/Apps/Navidrome/thumbnail.png
  index: /
  
  tagline:
    en_us: Your personal music streaming server with modern web interface
    zh_cn: 具有现代网页界面的个人音乐流媒体服务器
    ko_kr: 현대적인 웹 인터페이스를 갖춘 개인 음악 스트리밍 서버
  title:
    en_us: Navidrome
    zh_cn: Navidrome
    ko_kr: Navidrome
  store_app_id: navidrome
  main: navidrome
  is_uncontrolled: false
  webui_port: 4533