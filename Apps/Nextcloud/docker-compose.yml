name: nextcloud

services:
  nextcloud:
    image: nextcloud:30.0.6
    container_name: nextcloud
    user: $PUID:$PGID
    depends_on:
      - db
    deploy:
      resources:
        limits:
          memory: 1024M
          cpus: '1.0'
    expose:
      - 80
    environment:
      - PUID=$PUID
      - PGID=$PGID
      - TZ=$TZ
      - MYSQL_HOST=db
      - MYSQL_DATABASE=nextcloud
      - MYSQL_USER=nextcloud
      - MYSQL_PASSWORD=$default_pwd
      - NEXTCLOUD_ADMIN_USER=admin
      - NEXTCLOUD_ADMIN_PASSWORD=$default_pwd
      - NEXTCLOUD_TRUSTED_DOMAINS=localhost,$domain
      - OVERWRITEPROTOCOL=https
      - OVERWRITEHOST=$domain
      - TRUSTED_PROXIES=172.16.0.0/12,10.0.0.0/8,192.168.0.0/16
    volumes:
      - /DATA/AppData/$AppID/html:/var/www/html
      - /DATA/AppData/$AppID/apps:/var/www/html/custom_apps
      - /DATA/AppData/$AppID/config:/var/www/html/config
      - /DATA/AppData/$AppID/data:/var/www/html/data
      - /DATA/Documents:/var/www/html/data/Documents
      - /DATA/Media:/var/www/html/data/Media
      - /DATA/Gallery:/var/www/html/data/Gallery
    restart: unless-stopped
    networks:
      - nextcloud-network
    cpu_shares: 100

  db:
    image: mariadb:11.2
    container_name: nextcloud_db
    deploy:
      resources:
        limits:
          memory: 512M
          cpus: '0.5'
    environment:
      - TZ=$TZ
      - MYSQL_ROOT_PASSWORD=$default_pwd
      - MYSQL_DATABASE=nextcloud
      - MYSQL_USER=nextcloud
      - MYSQL_PASSWORD=$default_pwd
      - MARIADB_AUTO_UPGRADE=1
    volumes:
      - /DATA/AppData/$AppID/db:/var/lib/mysql
    restart: unless-stopped
    networks:
      - nextcloud-network
    cpu_shares: 50

networks:
  nextcloud-network:
    driver: bridge

x-casaos:
  main: nextcloud
  webui_port: 80
  category: Utilities
  architectures: [amd64, arm64]
  author: Yundera Team
  developer: Nextcloud GmbH
  description:
    en_us: Self-hosted cloud storage and collaboration platform. Install and enable collaboration apps like Calendar, Contacts, Talk, Deck, and Nextcloud Office to create your complete Microsoft Teams alternative with step-by-step guidance.
    ko_kr: 자체 호스팅 클라우드 스토리지 및 협업 플랫폼. Calendar, Contacts, Talk, Deck, Nextcloud Office 등의 협업 앱을 설치하고 활성화하여 단계별 가이드로 완전한 Microsoft Teams 대안을 만드세요.
    zh_cn: 自托管云存储和协作平台。安装并启用Calendar、Contacts、Talk、Deck和Nextcloud Office等协作应用程序，通过分步指导创建完整的Microsoft Teams替代方案。
    fr_fr: Plateforme de stockage cloud et de collaboration auto-hebergee. Installez et activez des applications de collaboration comme Calendar, Contacts, Talk, Deck et Nextcloud Office pour creer votre alternative complete a Microsoft Teams avec un guide etape par etape.
    es_es: Plataforma de almacenamiento en la nube y colaboracion autohospedada. Instale y habilite aplicaciones de colaboracion como Calendar, Contacts, Talk, Deck y Nextcloud Office para crear su alternativa completa a Microsoft Teams con orientacion paso a paso.
  title:
    en_us: Nextcloud Teams
    ko_kr: Nextcloud Teams
    zh_cn: Nextcloud Teams
    fr_fr: Nextcloud Teams
    es_es: Nextcloud Teams
  tagline:
    en_us: Build your Teams alternative with guided app installation
    ko_kr: 가이드된 앱 설치로 Teams 대안 구축
    zh_cn: 通过引导式应用安装构建您的Teams替代方案
    fr_fr: Construisez votre alternative Teams avec l'installation guidee d'applications
    es_es: Construya su alternativa a Teams con instalacion guiada de aplicaciones
  icon: https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/Nextcloud/icon.png
  screenshot_link:
    - https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/Nextcloud/screenshot-1.png
    - https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/Nextcloud/screenshot-2.png
    - https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/Nextcloud/screenshot-3.png
  thumbnail: https://cdn.jsdelivr.net/gh/Yundera/AppStore@main/Apps/Nextcloud/thumbnail.png
  tips:
    before_install:
      en_us: |
        **Default Account**
        | Username | Password       |
        | -------- | -------------- |
        | `admin`  | `$default_pwd` |
        
        **Setup Process:**
        
        **1. Wait for Setup (3-5 minutes):**
        - Initial installation takes time
        - Admin account created automatically
        - ⚠️ **Don't access until setup complete**
        
        **2. First Access:**
        - Login with credentials above
        - Skip any setup wizard (auto-completed)
        
        **3. Add Team Apps (Profile → Apps):**
        **Enable Built-in:** Calendar, Contacts, Mail
        **Install from Store:** Talk, Deck, Tasks, Nextcloud Office
        
        **Files sync to:** `/DATA/Documents` & `/DATA/Media`
        
      ko_kr: |
        **기본 계정**
        | 사용자명 | 비밀번호       |
        | -------- | -------------- |
        | `admin`  | `$default_pwd` |
        
        **설정 과정:**
        
        **1. 설정 대기 (3-5분):**
        - 초기 설치에 시간 소요
        - 관리자 계정 자동 생성
        - ⚠️ **설정 완료까지 접속 금지**
        
        **2. 첫 접속:**
        - 위 자격증명으로 로그인
        - 설정 마법사 건너뛰기 (자동 완료됨)
        
        **3. 팀 앱 추가 (프로필 → 앱):**
        **내장 앱 활성화:** Calendar, Contacts, Mail
        **스토어에서 설치:** Talk, Deck, Tasks, Nextcloud Office
        
        **파일 동기화:** `/DATA/Documents` & `/DATA/Media`
  index: /